<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>INVOICE/MONEY RECEIPT</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f5f5;
      padding: 20px;
    }
    .container {
      max-width: 900px;
      margin: auto;
      background: white;
      padding: 25px;
      border-radius: 10px;
        box-shadow: none; /* No outer border/shadow */
    }
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    .header img {
      max-height: 60px;
    }
    .header .info {
      text-align: right;
    }
    h2 {
      text-align: center;
      margin-bottom: 10px;
    }
    .form-row {
      display: flex;
      gap: 15px;
      margin-bottom: 10px;
    }
    .form-row input, .form-row select {
      flex: 1;
      padding: 6px;
      font-size: 14px;
    }
    label {
      font-weight: bold;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 6px;
      text-align: center;
    }
    th.small-cell, td.small-cell {
      width: 60px;
    }
    .actions {
      margin-top: 15px;
      display: flex;
      justify-content: space-between;
    }
    .totals {
      margin-top: 20px;
      text-align: right;
    }
    .totals div {
      margin: 5px 0;
    }
    .qr {
      text-align: center;
      margin-top: 20px;
    }
    .no-print {
      display: inline-block;
    }
    @media print {
      .no-print {
        display: none;
      }
      select, input {
        font-size: 11px;
        padding: 0;
        border: none;
        appearance: none;
        background: none;
        color: black;
      }
    }
  </style>
</head>
<body>
  <div class="container">
  <div id="passwordScreen" style="text-align: center; margin-top: 100px;">
  <h2>Please enter password to access the invoice</h2>
  <input type="password" id="passwordInput" placeholder="Enter password" style="padding: 8px; font-size: 16px;">
  <button onclick="checkPassword()" style="padding: 8px 16px; font-size: 16px;">Submit</button>
</div>

<div id="protectedContent" style="display:none;">

    <div class="header">
      <img src="https://i.ibb.co/WNZTWPwv/LOGO-PNG-2025-fab.png" alt="Logo">
      <div class="info">
        <div><strong>G10 EDUCATIONAL PLATFORM </strong></div>
        <div>Jayanagar Charali, Beltola Bazar Road, Guwahati-28, Ph. No.: 9706380357</div>
        <div>
          Date: <input type="date" id="invoiceDateInput" />
        </div>
        <div>Invoice No: <span id="invoiceNo">-</span></div>
      </div>
    </div>

    <h2>INVOICE/MONEY RECEIPT</h2>

    <div class="form-row">
      <select id="studentSelect" onchange="handleStudentChange()">
        <option value="">-- Select Student --</option>
      </select>
      <select id="invoiceSelect" onchange="loadInvoiceByNumber()">
        <option value="">-- Load Invoice No. --</option>
      </select>
    </div>

    <div class="form-row">
      <input type="text" id="studentName" placeholder="Student Name" />
      <input type="text" id="phone" placeholder="Phone Number" />
    </div>
    <div class="form-row">
      <input type="email" id="email" placeholder="Email ID" />
      <input type="text" id="address" placeholder="Address" />
    </div>
    <div class="form-row">
      <select id="studentClass">
        <option>Class 9</option>
        <option>Class 10</option>
        <option>Class 11</option>
        <option>Class 12</option>
        <option>IIT-JEE</option>
        <option>NEET</option>
        <option>CUET</option>
      </select>
    </div>

    <table class="invoice-table" id="invoiceTable" style="display: none;">
      <thead>
        <tr>
          <th colspan="2">Date</th>
          <th rowspan="2">Service Type</th>
          <th rowspan="2">Subject</th>
          <th rowspan="2" class="small-cell">No's of Class</th>
          <th rowspan="2" class="small-cell">Rate</th>
          <th rowspan="2">Total</th>
          <th rowspan="2" class="no-print">Action</th>
        </tr>
        <tr><th>From</th><th>To</th></tr>
      </thead>
      <tbody id="billBody"></tbody>
    </table>

    <div class="actions">
      <button onclick="addItem()" class="no-print">+ Add Coaching</button>
      <button onclick="window.print()" class="no-print">üñ®Ô∏è Print Invoice</button>
      <button onclick="saveInvoice()" class="no-print">üíæ Save Invoice</button>
    </div>

    <div class="totals">
      <div id="grandTotal">Total Amount: ‚Çπ0.00</div>
      <div id="amountInWords">Total (in words): Zero Rupees Only</div>
      <div>
        Amount Paid: ‚Çπ<input type="number" id="amountPaid" value="0" min="0" oninput="calculateTotal()" style="width: 100px;">
      </div>
      <div id="dueBalance">Due Balance: ‚Çπ0.00</div>
    </div>

    <div class="qr">
    <p style="font-weight:bold; color:green; text-align:left;">Scan the Below QR to Pay the Fee:</p>

      <div id="qrCanvas"></div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <script>
    const invoiceDateInput = document.getElementById("invoiceDateInput");
    invoiceDateInput.valueAsDate = new Date();

    function generateInvoiceNo() {
      return "INV-" + Date.now();
    }

    function handleStudentChange() {
      const name = document.getElementById("studentSelect").value;
      const students = JSON.parse(localStorage.getItem("students") || "{}");
      if (students[name]) {
        const s = students[name];
        document.getElementById("studentName").value = name;
        document.getElementById("phone").value = s.phone;
        document.getElementById("email").value = s.email;
        document.getElementById("address").value = s.address;
        document.getElementById("studentClass").value = s.class;
      } else {
        document.getElementById("studentName").value = name;
      }
      document.getElementById("invoiceNo").textContent = generateInvoiceNo();
    }

    function saveInvoice() {
      const name = document.getElementById("studentName").value.trim();
      if (!name) return alert("Enter student name.");

      let invoiceNo = document.getElementById("invoiceNo").textContent;
      if (invoiceNo === "-") {
        invoiceNo = generateInvoiceNo();
        document.getElementById("invoiceNo").textContent = invoiceNo;
      }

      const invoice = {
        name,
        phone: document.getElementById("phone").value,
        email: document.getElementById("email").value,
        address: document.getElementById("address").value,
        class: document.getElementById("studentClass").value,
        date: invoiceDateInput.value,
        amountPaid: document.getElementById("amountPaid").value,
        rows: Array.from(document.querySelectorAll("#billBody tr")).map(row => ({
          from: row.children[0].children[0].value,
          to: row.children[1].children[0].value,
          type: row.children[2].children[0].value,
          subject: row.children[3].children[0].value,
          qty: row.children[4].children[0].value,
          rate: row.children[5].children[0].value
        }))
      };

      const invoices = JSON.parse(localStorage.getItem("invoices") || "{}");
      invoices[invoiceNo] = invoice;
      localStorage.setItem("invoices", JSON.stringify(invoices));

      const students = JSON.parse(localStorage.getItem("students") || "{}");
      students[name] = {
        phone: invoice.phone,
        email: invoice.email,
        address: invoice.address,
        class: invoice.class
      };
      localStorage.setItem("students", JSON.stringify(students));

      populateDropdowns();
      document.getElementById("invoiceSelect").value = invoiceNo;
      alert("Invoice Saved!");
    }

    function populateDropdowns() {
      const students = JSON.parse(localStorage.getItem("students") || "{}");
      const studentSelect = document.getElementById("studentSelect");
      studentSelect.innerHTML = `<option value="">STUDENT NAME</option>`;
      Object.keys(students).forEach(name => {
        const option = document.createElement("option");
        option.value = name;
        option.textContent = name;
        studentSelect.appendChild(option);
      });

      const invoices = JSON.parse(localStorage.getItem("invoices") || "{}");
      const invoiceSelect = document.getElementById("invoiceSelect");
      invoiceSelect.innerHTML = `<option value="">-- Load Invoice No. --</option>`;
      Object.keys(invoices).forEach(no => {
        const option = document.createElement("option");
        option.value = no;
        option.textContent = no;
        invoiceSelect.appendChild(option);
      });
    }

    function loadInvoiceByNumber() {
      const invoiceNo = document.getElementById("invoiceSelect").value;
      const invoices = JSON.parse(localStorage.getItem("invoices") || "{}");
      const invoice = invoices[invoiceNo];
      if (!invoice) return;

      document.getElementById("studentName").value = invoice.name;
      document.getElementById("phone").value = invoice.phone;
      document.getElementById("email").value = invoice.email;
      document.getElementById("address").value = invoice.address;
      document.getElementById("studentClass").value = invoice.class;
      document.getElementById("invoiceDateInput").value = invoice.date;
      document.getElementById("amountPaid").value = invoice.amountPaid;
      document.getElementById("invoiceNo").textContent = invoiceNo;

      const billBody = document.getElementById("billBody");
      billBody.innerHTML = "";
      document.getElementById("invoiceTable").style.display = "table";
      invoice.rows.forEach(row => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td><input type="date" value="${row.from}"></td>
          <td><input type="date" value="${row.to}"></td>
          <td><select>
            <option${row.type === 'Individual Coaching' ? ' selected' : ''}>Individual Coaching</option>
            <option${row.type === 'Home Tuition' ? ' selected' : ''}>Home Tuition</option>
            <option${row.type === 'Group Coaching' ? ' selected' : ''}>Group Coaching</option>
            <option${row.type === 'Dual Coaching' ? ' selected' : ''}>Dual Coaching</option>
            <option${row.type === 'Super Group Coaching' ? ' selected' : ''}>Super Group Coaching</option>
			
          </select></td>
          <td><select>
            <option${row.subject === 'Physics' ? ' selected' : ''}>Physics</option>
            <option${row.subject === 'Chemistry' ? ' selected' : ''}>Chemistry</option>
            <option${row.subject === 'Math' ? ' selected' : ''}>Math</option>
            <option${row.subject === 'Biology' ? ' selected' : ''}>Biology</option>
            <option${row.subject === 'Science' ? ' selected' : ''}>Science</option>
          </select></td>
          <td><input type="number" value="${row.qty}" onchange="calculateTotal()" style="width:60px;"></td>
          <td><input type="number" value="${row.rate}" class="rate" onchange="calculateTotal()" style="width:80px;"></td>
          <td class="item-total">0</td>
          <td class="no-print"><button onclick="this.closest('tr').remove();calculateTotal()">Delete</button></td>
        `;
        billBody.appendChild(tr);
      });
      calculateTotal();
    }

    function addItem() {
      document.getElementById("invoiceTable").style.display = "table";
      const row = document.createElement("tr");
      row.innerHTML = `
        <td><input type="date"></td>
        <td><input type="date"></td>
        <td><select>
          <option>Individual Coaching</option>
          <option>Home Tuition</option>
          <option>Group Coaching</option>
		  <option>Dual Coaching</option>
		  <option>Super Group Coaching</option>
        </select></td>
        <td><select>
          <option>Physics</option>
          <option>Chemistry</option>
          <option>Math</option>
          <option>Biology</option>
          <option>Science</option>
        </select></td>
        <td><input type="number" value="1" min="1" onchange="calculateTotal()" style="width: 60px;"></td>
        <td><input type="number" value="1000" min="0" class="rate" onchange="calculateTotal()" style="width: 80px;"></td>
        <td class="item-total">1000</td>
        <td class="no-print"><button onclick="this.closest('tr').remove();calculateTotal()">Delete</button></td>
      `;
      document.getElementById("billBody").appendChild(row);
      calculateTotal();
    }

    function calculateTotal() {
      const rows = document.querySelectorAll("#billBody tr");
      let grandTotal = 0;
      rows.forEach(row => {
        const qty = row.querySelector("td:nth-child(5) input").valueAsNumber || 0;
        const rate = row.querySelector("td:nth-child(6) input").valueAsNumber || 0;
        const total = qty * rate;
        row.querySelector(".item-total").textContent = total.toFixed(2);
        grandTotal += total;
      });
      document.getElementById("grandTotal").textContent = `Total Amount: ‚Çπ${grandTotal.toFixed(2)}`;
      document.getElementById("amountInWords").textContent = `Total (in words): ${convertNumberToWords(grandTotal)} Only`;
      const paid = document.getElementById("amountPaid").valueAsNumber || 0;
      const balance = grandTotal - paid;
      document.getElementById("dueBalance").textContent = `Due Balance: ‚Çπ${balance.toFixed(2)}`;
      updateQRCode(balance);

    }

   function convertNumberToWords(num) {
  const a = [
    '', 'One', 'Two', 'Three', 'Four', 'Five', 'Six', 'Seven', 'Eight', 'Nine', 'Ten',
    'Eleven', 'Twelve', 'Thirteen', 'Fourteen', 'Fifteen', 'Sixteen', 'Seventeen',
    'Eighteen', 'Nineteen'
  ];
  const b = [
    '', '', 'Twenty', 'Thirty', 'Forty', 'Fifty', 'Sixty', 'Seventy', 'Eighty', 'Ninety'
  ];

  if ((num = num.toString()).length > 9) return 'Amount too high';
  const n = ('000000000' + num).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);
  if (!n) return;

  let str = '';
  str += (n[1] != 0) ? (a[Number(n[1])] || b[n[1][0]] + ' ' + a[n[1][1]]) + ' Crore ' : '';
  str += (n[2] != 0) ? (a[Number(n[2])] || b[n[2][0]] + ' ' + a[n[2][1]]) + ' Lakh ' : '';
  str += (n[3] != 0) ? (a[Number(n[3])] || b[n[3][0]] + ' ' + a[n[3][1]]) + ' Thousand ' : '';
  str += (n[4] != 0) ? (a[Number(n[4])] || b[n[4][0]] + ' ' + a[n[4][1]]) + ' Hundred ' : '';
  str += (n[5] != 0) ? ((str != '') ? 'and ' : '') + (a[Number(n[5])] || b[n[5][0]] + ' ' + a[n[5][1]]) + ' ' : '';
  return str.trim() + ' Rupees';
}


    function updateQRCode(amount) {
      const upiID = "9706380357@ucobank";
      const payeeName = "G10 EDUCATIONAL PLATFORM";
      const upiURL = `upi://pay?pa=${upiID}&pn=${encodeURIComponent(payeeName)}&am=${amount.toFixed(2)}&cu=INR`;
      const qrCanvas = document.getElementById("qrCanvas");
      qrCanvas.innerHTML = "";
      new QRCode(qrCanvas, {
        text: upiURL,
        width: 100,
        height: 100,
      });
    }

    populateDropdowns();
    updateQRCode(0);
  </script>
  </div> <!-- End of protectedContent -->
  <div class="notes" style="margin-top: 30px; font-size: 10px;">
  <p><strong>Note:</strong></p>
  <ol style="padding-left: 20px;">
    <li>This is a computer-generated invoice; signature is not required.</li>
    <li>Fee once paid is not refundable.</li>
  </ol>
</div>


<script>
  function checkPassword() {
    const password = document.getElementById("passwordInput").value;
    const correctPassword = "7099050509"; // ‚úÖ Change this to your desired password
    if (password === correctPassword) {
      document.getElementById("passwordScreen").style.display = "none";
      document.getElementById("protectedContent").style.display = "block";
    } else {
      alert("Incorrect password. Try again.");
    }
  }
</script>

</body>
</html>
